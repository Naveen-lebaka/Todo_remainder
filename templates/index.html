<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>ToDo Reminder App</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="container">
        <header class="top-row card">
            <h1>ðŸ•’ ToDo Reminder</h1>
            <div class="dnd-wrapper">
                <label class="dnd-label">ðŸ”• DND
                    <input type="checkbox" id="dnd-toggle">
                </label>
            </div>
        </header>

        <form method="POST" action="/add" class="form card">
            <div class="form-row">
                <input type="text" name="title" placeholder="Enter task title" required>
            </div>
            <div class="form-row split">
                <input type="date" name="date" required>
                <input type="time" name="time" required>
            </div>
            <div class="form-row">
                <select name="frequency">
                    <option value="">One Time</option>
                    <option value="daily">Every Day</option>
                    <option value="monthly">Every Month</option>
                    <option value="yearly">Every Year</option>
                </select>
            </div>
            <div class="form-row">
                <button type="submit" class="btn primary">Add Task</button>
            </div>
        </form>

        <div class="tasks card">
            {% if tasks %}
            <ul class="task-list">
                {% for task in tasks %}
                <li class="task-item">
                    <div class="task-left">
                        <div class="task-title">{{ task.title }}</div>
                        <div class="task-meta">{{ task.date }} â€¢ {{ task.time }}</div>
                    </div>
                    <div class="task-right">
                        {% if task.frequency %}
                        <span class="badge">{{ task.frequency }}</span>
                        {% endif %}
                        <!-- Updated label: Mark as Complete -->
                        <a href="/complete/{{ task.id }}" class="btn small">Mark as Complete</a>

                        <form method="POST" action="/delete/{{ task.id }}" class="inline-delete"
                            onsubmit="return confirmDelete();">
                            <button type="submit" class="btn small delete">Delete</button>
                        </form>
                    </div>
                </li>
                {% endfor %}
            </ul>
            {% else %}
            <div class="empty">No tasks yet â€” add one above âœ¨</div>
            {% endif %}
        </div>

        {% with messages = get_flashed_messages() %}
        {% if messages %}
        <div class="alert card">
            {% for msg in messages %}
            <p>{{ msg }}</p>
            {% endfor %}
        </div>
        {% endif %}
        {% endwith %}

        <div id="time-display"></div>
    </div>

    {% include 'reminder_popup.html' %}

    <script>
        function confirmDelete() {
            return confirm("Are you sure you want to permanently delete this reminder? This cannot be undone.");
        }
    </script>
</body>

</html>